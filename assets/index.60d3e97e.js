import{r as s,R as n,e as v,a as A}from"./vendor.43c92bb8.js";const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}};B();var x="/mozjpeg-on-browser/assets/logo.ecc203fb.svg";window.Buffer=buffer.Buffer;async function z(c){const e=document.createElement("img");e.src=c,await new Promise(t=>e.onload=t);const r=document.createElement("canvas");[r.width,r.height]=[e.width,e.height];const a=r.getContext("2d");if(a)return a.drawImage(e,0,0),a.getImageData(0,0,e.width,e.height)}async function S(c){const e=document.createElement("img");e.src=c,await new Promise(t=>e.onload=t);const r=document.createElement("canvas");[r.width,r.height]=[e.width,e.height];const a=r.getContext("2d");if(a)return a.drawImage(e,0,0),R(a.canvas.toDataURL("image/jpeg",.8))}function R(c){for(var e=atob(c.replace(/^.*,/,"")),r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);try{var t=new Blob([r.buffer],{type:"image/png"})}catch{return!1}return t}const d=c=>Math.round(c/1024);function I(){const c=s.exports.useRef(null),e=s.exports.useRef(null),[r,a]=s.exports.useState(null),[t,o]=s.exports.useState(0),[i,E]=s.exports.useState(0),[w,y]=s.exports.useState(0),b=async()=>{var f;const u=((f=c.current)==null?void 0:f.files)||[];if(u[0]){o(d(u[0].size));const g=new FileReader;g.onload=async m=>{if(m.target){const l=await z(m.target.result),p=await S(m.target.result);if(p&&E(d(p.size)),l){const h=await v(l.data.buffer,{width:l.width,height:l.height,channels:4},{quality:80,colorSpace:3});y(d(new Blob([h.buffer],{type:"image/jpeg"}).size)),a(h)}}},g.readAsDataURL(u[0])}};return s.exports.useEffect(()=>{r&&(console.log(r),e.current&&(e.current.src=URL.createObjectURL(new Blob([r],{type:"image/jpeg"}))))},[r]),n.createElement("div",{className:"App"},n.createElement("header",{className:"App-header"},n.createElement("img",{src:x,className:"App-logo",alt:"logo"}),n.createElement("p",null,"Sample of compressing an image in a browser using mozJPEG"),n.createElement("p",null,n.createElement("input",{ref:c,accept:"image/*",type:"file",onChange:b})),t>0&&n.createElement(n.Fragment,null,n.createElement("p",{style:{fontSize:"0.75rem"}},"\u30AA\u30EA\u30B8\u30CA\u30EB\u30B5\u30A4\u30BA: ",t," KB\u2003 JPEG 80%: ",i," KB"),n.createElement("h4",{style:{marginBottom:"5px"}},"mozJPEG 80%: ",w," KB")),n.createElement("img",{ref:e,src:"",alt:"",style:{width:"600px"}}),n.createElement("p",null,"Edit ",n.createElement("code",null,"App.tsx")," and save to test HMR updates."),n.createElement("p",null,n.createElement("a",{className:"App-link",href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer"},"Learn React")," | ",n.createElement("a",{className:"App-link",href:"https://vitejs.dev/guide/features.html",target:"_blank",rel:"noopener noreferrer"},"Vite Docs"))))}A.render(n.createElement(n.StrictMode,null,n.createElement(I,null)),document.getElementById("root"));
